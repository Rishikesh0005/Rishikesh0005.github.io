<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gift Shuffler</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background: #0b1220; color: #e8eefc; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 28px 16px 48px; }
    .card {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }
    h1 { font-size: 22px; margin: 0 0 8px; }
    p { margin: 8px 0 14px; line-height: 1.5; color: rgba(232,238,252,0.85); }
    label { display: block; margin: 14px 0 8px; font-weight: 600; }
    select, input, button {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.25);
      color: #e8eefc;
      font-size: 15px;
      outline: none;
    }
    button { margin-top: 12px; background: rgba(99, 102, 241, 0.9); border: 0; cursor: pointer; font-weight: 700; }
    button:hover { filter: brightness(1.05); }
    .result {
      margin-top: 16px;
      padding: 14px;
      border-radius: 14px;
      background: rgba(34,197,94,0.12);
      border: 1px solid rgba(34,197,94,0.25);
    }
    .result strong { font-size: 18px; }
    .muted { color: rgba(232,238,252,0.7); font-size: 13px; margin-top: 10px; }
    code { background: rgba(255,255,255,0.08); padding: 2px 6px; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>üéÅ Gift Shuffler (Hash-based)</h1>
      <p>
        Select <b>your name</b> and reveal your giftee.<br/>
        The pairing is generated from a <b>seed</b> (hash), so it looks shuffled but stays consistent.
      </p>

      <label for="seed">Seed (change once to reshuffle, then keep fixed)</label>
      <input id="seed" value="gift-2025" />

      <label for="me">Choose your name</label>
      <select id="me"></select>

      <button id="reveal">Reveal</button>

      <div id="out"></div>

      <div class="muted">
        Share the same site + same seed with everyone. Example seed: <code>gift-2025</code>
      </div>
    </div>
  </div>

<script>
const NAMES = [
  "Duckchin",
  "Dheeksha",
  "Aparna",
  "Rishikesh",
  "Girish Annan Jerish",
  "Mohini"
];

// --- Seeded shuffle helpers (hash -> PRNG) ---
function xmur3(str) {
  let h = 1779033703 ^ str.length;
  for (let i = 0; i < str.length; i++) {
    h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
    h = (h << 13) | (h >>> 19);
  }
  return function() {
    h = Math.imul(h ^ (h >>> 16), 2246822507);
    h = Math.imul(h ^ (h >>> 13), 3266489909);
    h ^= h >>> 16;
    return h >>> 0;
  };
}
function mulberry32(a) {
  return function() {
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}
function seededShuffle(arr, seedStr) {
  const seed = xmur3(seedStr)();
  const rand = mulberry32(seed);
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(rand() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// Build a unique 1-to-1 mapping using a single cycle from the shuffled list
function buildMapping(seedStr) {
  const perm = seededShuffle(NAMES, seedStr);
  const mapping = {};
  for (let i = 0; i < perm.length; i++) {
    mapping[perm[i]] = perm[(i + 1) % perm.length];
  }

  // Safety: ensure no one maps to self (extremely unlikely with cycle, but kept anyway)
  for (let i = 0; i < perm.length; i++) {
    const n = perm[i];
    if (mapping[n] === n) {
      const swapWith = perm[(i + 1) % perm.length];
      const tmp = mapping[n];
      mapping[n] = mapping[swapWith];
      mapping[swapWith] = tmp;
    }
  }
  return mapping;
}

const meSelect = document.getElementById("me");
const seedInput = document.getElementById("seed");
const out = document.getElementById("out");

function populateNames() {
  meSelect.innerHTML = "";
  for (const n of NAMES) {
    const opt = document.createElement("option");
    opt.value = n;
    opt.textContent = n;
    meSelect.appendChild(opt);
  }
}

function escapeHtml(s) {
  return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
}

function reveal() {
  const seed = seedInput.value.trim() || "gift-2025";
  const me = meSelect.value;

  const mapping = buildMapping(seed);
  const assigned = mapping[me];

  out.innerHTML = `
    <div class="result">
      You are <strong>${escapeHtml(me)}</strong> ‚úÖ<br/>
      You should gift: <strong>${escapeHtml(assigned)}</strong> üéÅ
      <div class="muted">Deterministic from seed: <code>${escapeHtml(seed)}</code></div>
    </div>
  `;
}

document.getElementById("reveal").addEventListener("click", reveal);

populateNames();
</script>
</body>
</html>
